<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Settings</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f4f8;
            color: #333;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        .container {
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #4CAF50;
            font-size: 24px;
            margin-bottom: 20px;
        }
        h2 {
            color: #333;
            font-size: 20px;
            margin: 20px 0 10px;
        }
        input[type="file"], select {
            margin: 10px 0;
            padding: 10px;
            width: calc(100% - 22px);
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
            color: #333;
        }
        td {
            background-color: #fff;
        }
        .button {
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 14px;
            transition: background-color 0.3s, transform 0.2s;
            margin: 5px;
            display: inline-block;
            text-align: center;
        }
        .button:hover {
            background-color: #45a049;
        }
        .button:active {
            transform: scale(0.98);
        }
        .accessibility-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #007bff;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .accessibility-btn:hover {
            background-color: #0056b3;
        }
        .accessibility-menu {
            display: none;
            position: fixed;
            bottom: 80px;
            right: 20px;
            background-color: #ffffff;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 10px;
            z-index: 1000;
            width: 200px;
        }
        .accessibility-menu h3 {
            margin: 0 0 10px;
            font-size: 16px;
            color: #333;
        }
        .accessibility-menu button {
            background: none;
            border: none;
            font-size: 16px;
            color: #007bff;
            cursor: pointer;
            margin: 5px 0;
            display: block;
            width: 100%;
            text-align: left;
        }
        .accessibility-menu button:hover {
            text-decoration: underline;
        }
        .vcard-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
            transition: background-color 0.3s;
        }
        .vcard-button:hover {
            background-color: #0056b3;
        }
        .vcard-button:active {
            transform: scale(0.98);
        }
        .mini-menu-tab {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #333;
            color: white;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            z-index: 1000;
        }
        .mini-menu-content {
            display: none;
            position: fixed;
            bottom: 60px;
            right: 20px;
            background-color: #ffffff;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 10px;
            z-index: 1000;
            width: 250px;
        }
        .mini-menu-content button {
            background: none;
            border: none;
            font-size: 16px;
            color: #007bff;
            cursor: pointer;
            margin: 5px 0;
            display: block;
            width: 100%;
            text-align: left;
        }
        .mini-menu-content button:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Upload and Process Excel File</h1>
        <input type="file" id="upload" />
        <button class="button" onclick="processFile()">Process File</button>

        <h2>Select Columns</h2>
        <select id="column-select" multiple>
            <!-- Options will be populated dynamically -->
        </select>

        <h2>Data</h2>
        <table id="data-table">
            <thead>
                <tr id="table-headers">
                    <!-- Headers will be populated dynamically -->
                </tr>
            </thead>
            <tbody>
                <!-- Data will be inserted here -->
            </tbody>
        </table>

        <button class="vcard-button" onclick="generateVCard()">Generate vCard for All Numbers</button>
    </div>

    <button class="accessibility-btn" onclick="toggleAccessibilityMenu()">A</button>

    <div class="accessibility-menu" id="accessibilityMenu">
        <h3>Accessibility Settings</h3>
        <button onclick="adjustFontSize('increase')">Increase Font Size</button>
        <button onclick="adjustFontSize('decrease')">Decrease Font Size</button>
        <button onclick="adjustFontSize('reset')">Reset Font Size</button>
    </div>

    <div class="mini-menu-tab" onclick="toggleMiniMenu()">Advanced Settings</div>

    <div class="mini-menu-content" id="miniMenu">
        <button onclick="sortAscending()">Sort Ascending</button>
        <button onclick="sortDescending()">Sort Descending</button>
        <button onclick="filterByRange()">Filter by Range</button>
        <button onclick="highlightDuplicates()">Highlight Duplicates</button>
        <button onclick="removeDuplicates()">Remove Duplicates</button>
        <button onclick="showTopN()">Show Top N Values</button>
        <button onclick="showBottomN()">Show Bottom N Values</button>
        <button onclick="findAndReplace()">Find and Replace</button>
        <button onclick="toggleTableVisibility()">Toggle Table Visibility</button>
        <button onclick="freezePane()">Freeze Pane</button>
        <button onclick="exportToPDF()">Export to PDF</button>
        <button onclick="importFromCSV()">Import from CSV</button>
        <button onclick="applyTheme()">Apply Theme</button>
        <button onclick="customSorting()">Custom Sorting</button>
        <button onclick="addRowNumbers()">Add Row Numbers</button>
        <button onclick="mergeCells()">Merge Cells</button>
        <button onclick="unmergeCells()">Unmerge Cells</button>
        <button onclick="addWatermark()">Add Watermark</button>
        <button onclick="toggleRowNumbers()">Show/Hide Row Numbers</button>
        <button onclick="lockTable()">Lock Table</button>
        <button onclick="unlockTable()">Unlock Table</button>
        <button onclick="addComments()">Add Comments</button>
        <button onclick="searchTable()">Search Table</button>
        <button onclick="clearTable()">Clear Table</button>
        <button onclick="exportToExcel()">Export to Excel</button>
        <button onclick="importFromJSON()">Import from JSON</button>
        <button onclick="duplicateRow()">Duplicate Row</button>
        <button onclick="deleteRow()">Delete Row</button>
        <button onclick="addFilter()">Add Filter</button>
        <button onclick="removeFilter()">Remove Filter</button>
        <button onclick="splitColumn()">Split Column</button>
        <button onclick="mergeRows()">Merge Rows</button>
        <button onclick="sortMultiple()">Sort Multiple Columns</button>
        <button onclick="conditionalFormatting()">Conditional Formatting</button>
        <button onclick="generateReport()">Generate Report</button>
        <button onclick="sendToEmail()">Send to Email</button>
        <button onclick="sendToWhatsApp()">Send to WhatsApp</button>
        <button onclick="createPivotTable()">Create Pivot Table</button>
        <button onclick="importFromXML()">Import from XML</button>
        <button onclick="dataValidation()">Data Validation</button>
        <button onclick="generateSummary()">Generate Summary</button>
        <button onclick="highlightErrors()">Highlight Errors</button>
        <button onclick="saveChanges()">Save Changes</button>
        <button onclick="discardChanges()">Discard Changes</button>
        <button onclick="showDetails()">Show Details</button>
        <button onclick="refreshData()">Refresh Data</button>
        <button onclick="createChart()">Create Chart</button>
        <button onclick="addAnnotations()">Add Annotations</button>
    </div>

    <script>
        document.getElementById('upload').addEventListener('change', processFile);

        function processFile() {
            const file = document.getElementById('upload').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetNames = workbook.SheetNames;
                    const sheet = workbook.Sheets[sheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(sheet);
                    displayData(jsonData);
                    populateColumnSelect(Object.keys(jsonData[0]));
                };
                reader.readAsArrayBuffer(file);
            }
        }

        function displayData(data) {
            const tableHeaders = document.getElementById('table-headers');
            const tableBody = document.getElementById('data-table').getElementsByTagName('tbody')[0];
            tableHeaders.innerHTML = '';
            tableBody.innerHTML = '';
            if (data.length > 0) {
                const headers = Object.keys(data[0]);
                headers.forEach(header => {
                    const th = document.createElement('th');
                    th.textContent = header;
                    tableHeaders.appendChild(th);
                });
                data.forEach(row => {
                    const tr = document.createElement('tr');
                    headers.forEach(header => {
                        const td = document.createElement('td');
                        td.textContent = row[header] || '';
                        tr.appendChild(td);
                    });
                    tableBody.appendChild(tr);
                });
            }
        }

        function populateColumnSelect(columns) {
            const columnSelect = document.getElementById('column-select');
            columnSelect.innerHTML = '';
            columns.forEach(col => {
                const option = document.createElement('option');
                option.value = col;
                option.textContent = col;
                columnSelect.appendChild(option);
            });
        }

        function generateVCard() {
            // Implement vCard generation logic
        }

        function toggleAccessibilityMenu() {
            const menu = document.getElementById('accessibilityMenu');
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        }

        function toggleMiniMenu() {
            const menu = document.getElementById('miniMenu');
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        }

        function sortAscending() { /* implementation */ }
        function sortDescending() { /* implementation */ }
        function filterByRange() { /* implementation */ }
        function highlightDuplicates() { /* implementation */ }
        function removeDuplicates() { /* implementation */ }
        function showTopN() { /* implementation */ }
        function showBottomN() { /* implementation */ }
        function findAndReplace() { /* implementation */ }
        function toggleTableVisibility() { /* implementation */ }
        function freezePane() { /* implementation */ }
        function exportToPDF() { /* implementation */ }
        function importFromCSV() { /* implementation */ }
        function applyTheme() { /* implementation */ }
        function customSorting() { /* implementation */ }
        function addRowNumbers() { /* implementation */ }
        function mergeCells() { /* implementation */ }
        function unmergeCells() { /* implementation */ }
        function addWatermark() { /* implementation */ }
        function toggleRowNumbers() { /* implementation */ }
        function lockTable() { /* implementation */ }
        function unlockTable() { /* implementation */ }
        function addComments() { /* implementation */ }
        function searchTable() { /* implementation */ }
        function clearTable() { /* implementation */ }
        function exportToExcel() { /* implementation */ }
        function importFromJSON() { /* implementation */ }
        function duplicateRow() { /* implementation */ }
        function deleteRow() { /* implementation */ }
        function addFilter() { /* implementation */ }
        function removeFilter() { /* implementation */ }
        function splitColumn() { /* implementation */ }
        function mergeRows() { /* implementation */ }
        function sortMultiple() { /* implementation */ }
        function conditionalFormatting() { /* implementation */ }
        function generateReport() { /* implementation */ }
        function sendToEmail() { /* implementation */ }
        function sendToWhatsApp() { /* implementation */ }
        function createPivotTable() { /* implementation */ }
        function importFromXML() { /* implementation */ }
        function dataValidation() { /* implementation */ }
        function generateSummary() { /* implementation */ }
        function highlightErrors() { /* implementation */ }
        function saveChanges() { /* implementation */ }
        function discardChanges() { /* implementation */ }
        function showDetails() { /* implementation */ }
        function refreshData() { /* implementation */ }
        function createChart() { /* implementation */ }
        function addAnnotations() { /* implementation */ }
    </script>
</body>
</html>
