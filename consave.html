<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Excel Processing</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f4f8;
            color: #333;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        .container {
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #4CAF50;
            font-size: 24px;
            margin-bottom: 20px;
        }
        h2 {
            color: #333;
            font-size: 20px;
            margin: 20px 0 10px;
        }
        input[type="file"], select {
            margin: 10px 0;
            padding: 10px;
            width: calc(100% - 22px);
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
            color: #333;
        }
        td {
            background-color: #fff;
        }
        .button {
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            font-size: 14px;
            transition: background-color 0.3s, transform 0.2s;
            margin: 5px;
            display: inline-block;
            text-align: center;
        }
        .button:hover {
            background-color: #45a049;
        }
        .button:active {
            transform: scale(0.98);
        }
        .accessibility-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #007bff;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .accessibility-btn:hover {
            background-color: #0056b3;
        }
        .accessibility-menu, .settings-menu {
            display: none;
            position: fixed;
            bottom: 80px;
            right: 20px;
            background-color: #ffffff;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 10px;
            z-index: 1000;
            width: 300px;
        }
        .accessibility-menu h3, .settings-menu h3 {
            margin: 0 0 10px;
            font-size: 16px;
            color: #333;
        }
        .accessibility-menu button, .settings-menu button {
            background: none;
            border: none;
            font-size: 16px;
            color: #007bff;
            cursor: pointer;
            margin: 5px 0;
            display: block;
            width: 100%;
            text-align: left;
        }
        .accessibility-menu button:hover, .settings-menu button:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Upload and Process Excel File</h1>
        <input type="file" id="upload" />
        <button class="button" onclick="processFile()">Process File</button>

        <h2>Select Column</h2>
        <select id="column-select">
            <option value="">Select Column</option>
        </select>

        <h2>Data</h2>
        <table id="data-table">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data will be inserted here -->
            </tbody>
        </table>

        <button class="button" onclick="generateVCard()">Generate vCard for All Numbers</button>
    </div>

    <button class="accessibility-btn" onclick="toggleAccessibilityMenu()">A</button>
    <button class="button" onclick="toggleSettingsMenu()">⚙️</button>

    <div class="accessibility-menu" id="accessibilityMenu">
        <h3>Accessibility Settings</h3>
        <button onclick="adjustFontSize('increase')">Increase Font Size</button>
        <button onclick="adjustFontSize('decrease')">Decrease Font Size</button>
        <button onclick="adjustFontSize('reset')">Reset Font Size</button>
    </div>

    <div class="settings-menu" id="settingsMenu">
        <h3>Advanced Settings</h3>
        <button onclick="copySelectedRows()">Copy Selected Rows</button>
        <button onclick="shareSelectedRows()">Share Selected Rows</button>
        <button onclick="sortTable('asc')">Sort Table Ascending</button>
        <button onclick="sortTable('desc')">Sort Table Descending</button>
        <button onclick="filterTable()">Filter Table</button>
        <button onclick="highlightDuplicates()">Highlight Duplicates</button>
        <button onclick="mergeCells()">Merge Cells</button>
        <button onclick="splitCells()">Split Cells</button>
        <button onclick="applyStyles()">Apply Styles</button>
        <button onclick="toggleRowVisibility()">Toggle Row Visibility</button>
        <button onclick="toggleTableVisibility()">Toggle Table Visibility</button>
        <button onclick="addRow()">Add Row</button>
        <button onclick="removeRow()">Remove Row</button>
        <button onclick="updateRow()">Update Row</button>
        <button onclick="addColumn()">Add Column</button>
        <button onclick="removeColumn()">Remove Column</button>
        <button onclick="updateColumn()">Update Column</button>
        <button onclick="printTable()">Print Table</button>
        <button onclick="resizeTable()">Resize Table</button>
        <button onclick="applyTheme()">Apply Theme</button>
        <button onclick="toggleTableHeaders()">Toggle Table Headers</button>
        <button onclick="resetTable()">Reset Table</button>
        <button onclick="exportToExcel()">Export to Excel</button>
        <button onclick="exportToPDF()">Export to PDF</button>
        <button onclick="importFromExcel()">Import from Excel</button>
        <button onclick="filterByCondition()">Filter by Condition</button>
        <button onclick="clearFilters()">Clear Filters</button>
        <button onclick="addComment()">Add Comment</button>
        <button onclick="removeComment()">Remove Comment</button>
        <button onclick="toggleSorting()">Toggle Sorting</button>
        <button onclick="showTableStats()">Show Table Stats</button>
        <button onclick="searchInTable()">Search in Table</button>
        <button onclick="addBookmark()">Add Bookmark</button>
        <button onclick="removeBookmark()">Remove Bookmark</button>
        <button onclick="setReminder()">Set Reminder</button>
        <button onclick="showHelp()">Show Help</button>
    </div>

    <script>
        let numbersArray = [];
        let columnHeaders = [];

        function processFile() {
            const fileInput = document.getElementById('upload');
            const file = fileInput.files[0];

            if (!file) {
                alert('Please select a file first.');
                return;
            }

            const reader = new FileReader();

            reader.onload = function(event) {
                const data = new Uint8Array(event.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                const json = XLSX.utils.sheet_to_json(worksheet);

                if (json.length === 0) {
                    alert('No data found in the file.');
                    return;
                }

                columnHeaders = Object.keys(json[0]);
                const columnSelect = document.getElementById('column-select');
                columnSelect.innerHTML = '<option value="">Select Column</option>'; // Clear previous options

                columnHeaders.forEach(header => {
                    const option = document.createElement('option');
                    option.value = header;
                    option.textContent = header;
                    columnSelect.appendChild(option);
                });

                populateTable(json);
            };

            reader.readAsArrayBuffer(file);
        }

        function populateTable(json) {
            const columnSelect = document.getElementById('column-select');
            const selectedColumn = columnSelect.value;
            const tableBody = document.querySelector('#data-table tbody');
            tableBody.innerHTML = ''; // Clear previous data

            if (!selectedColumn) {
                alert('Please select a column first.');
                return;
            }

            numbersArray = json.map(row => row[selectedColumn]).filter(number => number);

            if (numbersArray.length === 0) {
                alert('No valid numbers found.');
                return;
            }

            numbersArray.forEach(number => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${number}</td>
                    <td>
                        <button class="button" onclick="dialNumber('${number}')">Call</button>
                        <button class="button" onclick="openDialer('${number}')">Save to Contact</button>
                        <button class="button" onclick="downloadVCard('${number}')">Download VCard</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function copySelectedRows() {
            const selectedRows = document.querySelectorAll('#data-table tbody tr.selected');
            const data = Array.from(selectedRows).map(row => row.innerText).join('\n');
            navigator.clipboard.writeText(data).then(() => {
                alert('Selected rows copied to clipboard.');
            }).catch(err => {
                console.error('Failed to copy text: ', err);
            });
        }

        function shareSelectedRows() {
            const selectedRows = document.querySelectorAll('#data-table tbody tr.selected');
            const data = Array.from(selectedRows).map(row => row.innerText).join('\n');
            const shareData = {
                title: 'Shared Data',
                text: data
            };
            navigator.share(shareData).then(() => {
                alert('Shared successfully.');
            }).catch(err => {
                console.error('Failed to share data: ', err);
            });
        }

        function sortTable(order) {
            const table = document.getElementById('data-table');
            const rows = Array.from(table.querySelectorAll('tbody tr'));
            rows.sort((a, b) => {
                const aText = a.querySelector('td').innerText;
                const bText = b.querySelector('td').innerText;
                return order === 'asc' ? aText.localeCompare(bText) : bText.localeCompare(aText);
            });
            const tbody = table.querySelector('tbody');
            tbody.innerHTML = '';
            rows.forEach(row => tbody.appendChild(row));
        }

        function filterTable() {
            const filter = prompt('Enter filter text:');
            if (filter) {
                const rows = document.querySelectorAll('#data-table tbody tr');
                rows.forEach(row => {
                    const text = row.innerText.toLowerCase();
                    row.style.display = text.includes(filter.toLowerCase()) ? '' : 'none';
                });
            }
        }

        function highlightDuplicates() {
            const rows = document.querySelectorAll('#data-table tbody tr');
            const seen = new Set();
            rows.forEach(row => {
                const cell = row.querySelector('td').innerText;
                if (seen.has(cell)) {
                    row.style.backgroundColor = '#ffdddd';
                } else {
                    seen.add(cell);
                }
            });
        }

        function mergeCells() {
            // Placeholder for merge cells functionality
            alert('Merge cells functionality is not implemented.');
        }

        function splitCells() {
            // Placeholder for split cells functionality
            alert('Split cells functionality is not implemented.');
        }

        function applyStyles() {
            // Placeholder for apply styles functionality
            alert('Apply styles functionality is not implemented.');
        }

        function toggleRowVisibility() {
            const rows = document.querySelectorAll('#data-table tbody tr');
            rows.forEach(row => {
                row.style.display = row.style.display === 'none' ? '' : 'none';
            });
        }

        function toggleTableVisibility() {
            const table = document.getElementById('data-table');
            table.style.display = table.style.display === 'none' ? '' : 'none';
        }

        function addRow() {
            const tableBody = document.querySelector('#data-table tbody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>New Data</td>
                <td>
                    <button class="button" onclick="dialNumber('New Number')">Call</button>
                    <button class="button" onclick="openDialer('New Number')">Save to Contact</button>
                    <button class="button" onclick="downloadVCard('New Number')">Download VCard</button>
                </td>
            `;
            tableBody.appendChild(row);
        }

        function removeRow() {
            const selectedRows = document.querySelectorAll('#data-table tbody tr.selected');
            selectedRows.forEach(row => row.remove());
        }

        function updateRow() {
            const selectedRows = document.querySelectorAll('#data-table tbody tr.selected');
            selectedRows.forEach(row => {
                const cell = row.querySelector('td');
                cell.innerHTML = 'Updated Data';
            });
        }

        function addColumn() {
            const table = document.getElementById('data-table');
            const headers = table.querySelectorAll('thead th');
            const newHeader = document.createElement('th');
            newHeader.innerText = 'New Column';
            table.querySelector('thead tr').appendChild(newHeader);
            
            table.querySelectorAll('tbody tr').forEach(row => {
                const newCell = document.createElement('td');
                newCell.innerText = 'New Data';
                row.appendChild(newCell);
            });
        }

        function removeColumn() {
            const table = document.getElementById('data-table');
            const lastHeader = table.querySelector('thead th:last-child');
            if (lastHeader) {
                lastHeader.remove();
                table.querySelectorAll('tbody tr').forEach(row => row.lastChild.remove());
            }
        }

        function updateColumn() {
            const columnName = prompt('Enter column name to update:');
            const newValue = prompt('Enter new value:');
            const headers = Array.from(document.querySelectorAll('#data-table thead th'));
            headers.forEach(header => {
                if (header.innerText === columnName) {
                    const index = Array.from(header.parentNode.children).indexOf(header);
                    document.querySelectorAll('#data-table tbody tr').forEach(row => {
                        row.children[index].innerText = newValue;
                    });
                }
            });
        }

        function printTable() {
            const table = document.getElementById('data-table');
            const printWindow = window.open('', '', 'height=600,width=800');
            printWindow.document.write('<html><head><title>Print Table</title>');
            printWindow.document.write('</head><body >');
            printWindow.document.write(table.outerHTML);
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.focus();
            printWindow.print();
        }

        function resizeTable() {
            // Placeholder for resize table functionality
            alert('Resize table functionality is not implemented.');
        }

        function applyTheme() {
            // Placeholder for apply theme functionality
            alert('Apply theme functionality is not implemented.');
        }

        function toggleTableHeaders() {
            const headers = document.querySelector('#data-table thead');
            headers.style.display = headers.style.display === 'none' ? '' : 'none';
        }

        function resetTable() {
            const table = document.getElementById('data-table');
            table.querySelector('tbody').innerHTML = '';
            table.querySelector('thead').innerHTML = '<tr><th>Data</th><th>Action</th></tr>';
        }

        function exportToExcel() {
            // Placeholder for export to Excel functionality
            alert('Export to Excel functionality is not implemented.');
        }

        function exportToPDF() {
            // Placeholder for export to PDF functionality
            alert('Export to PDF functionality is not implemented.');
        }

        function importFromExcel() {
            // Placeholder for import from Excel functionality
            alert('Import from Excel functionality is not implemented.');
        }

        function filterByCondition() {
            const condition = prompt('Enter filter condition:');
            if (condition) {
                const rows = document.querySelectorAll('#data-table tbody tr');
                rows.forEach(row => {
                    const cell = row.querySelector('td').innerText;
                    row.style.display = cell.includes(condition) ? '' : 'none';
                });
            }
        }

        function clearFilters() {
            const rows = document.querySelectorAll('#data-table tbody tr');
            rows.forEach(row => row.style.display = '');
        }

        function addComment() {
            const comment = prompt('Enter comment:');
            if (comment) {
                const selectedRows = document.querySelectorAll('#data-table tbody tr.selected');
                selectedRows.forEach(row => {
                    const cell = row.querySelector('td');
                    cell.innerHTML += `<br><small>${comment}</small>`;
                });
            }
        }

        function removeComment() {
            // Placeholder for remove comment functionality
            alert('Remove comment functionality is not implemented.');
        }

        function toggleSorting() {
            // Placeholder for toggle sorting functionality
            alert('Toggle sorting functionality is not implemented.');
        }

        function showTableStats() {
            // Placeholder for show table stats functionality
            alert('Show table stats functionality is not implemented.');
        }

        function searchInTable() {
            const search = prompt('Enter search text:');
            if (search) {
                const rows = document.querySelectorAll('#data-table tbody tr');
                rows.forEach(row => {
                    const text = row.innerText.toLowerCase();
                    row.style.display = text.includes(search.toLowerCase()) ? '' : 'none';
                });
            }
        }

        function addBookmark() {
            // Placeholder for add bookmark functionality
            alert('Add bookmark functionality is not implemented.');
        }

        function removeBookmark() {
            // Placeholder for remove bookmark functionality
            alert('Remove bookmark functionality is not implemented.');
        }

        function setReminder() {
            // Placeholder for set reminder functionality
            alert('Set reminder functionality is not implemented.');
        }

        function showHelp() {
            // Placeholder for show help functionality
            alert('Show help functionality is not implemented.');
        }

        function toggleAccessibilityMenu() {
            const menu = document.getElementById('accessibilityMenu');
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        }

        function toggleSettingsMenu() {
            const menu = document.getElementById('settingsMenu');
            menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        }

        function adjustFontSize(action) {
            const body = document.body;
            let currentSize = window.getComputedStyle(body).fontSize;
            let newSize = parseFloat(currentSize);
            if (action === 'increase') newSize += 2;
            else if (action === 'decrease') newSize -= 2;
            else newSize = 16; // Reset size
            body.style.fontSize = newSize + 'px';
        }

        function dialNumber(number) {
            alert(`Dialing number: ${number}`);
            // Implement phone dialer functionality here
        }

        function openDialer(number) {
            alert(`Opening dialer to save number: ${number}`);
            // Implement phone dialer functionality here
        }

        function downloadVCard(number) {
            const vCardData = `BEGIN:VCARD\nVERSION:3.0\nFN:${number}\nTEL:${number}\nEND:VCARD`;
            const blob = new Blob([vCardData], { type: 'text/vcard' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `${number}.vcf`;
            link.click();
        }
    </script>
</body>
</html>
